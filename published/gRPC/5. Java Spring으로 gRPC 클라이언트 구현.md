# **ğŸ¯ 5ì¼ì°¨ í•™ìŠµ ëª©í‘œ: gRPC í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„**
1. **Stub ì‚¬ìš©ë²•**
    - BlockingStub (ë™ê¸° í˜¸ì¶œ)
    - FutureStub (ë¹„ë™ê¸°, Future ê¸°ë°˜)
    - AsyncStub (ì½œë°± ê¸°ë°˜ ë¹„ë™ê¸° í˜¸ì¶œ)
2. **í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±í•˜ê¸°**
3. **ê° í†µì‹  íŒ¨í„´ í˜¸ì¶œí•˜ê¸°**
    - Unary RPC í˜¸ì¶œ â†’ ì‘ë‹µ 1ê°œ ë°›ê¸°
    - Server Streaming í˜¸ì¶œ â†’ ìŠ¤íŠ¸ë¦¼ ìˆœíšŒí•˜ë©´ì„œ ì‘ë‹µ ì—¬ëŸ¬ ê°œ ë°›ê¸°
    - Client Streaming í˜¸ì¶œ â†’ ìš”ì²­ ì—¬ëŸ¬ ê°œ ë³´ë‚´ê³  ì‘ë‹µ 1ê°œ ë°›ê¸°
    - Bidirectional Streaming í˜¸ì¶œ â†’ ìš”ì²­ê³¼ ì‘ë‹µì„ ë™ì‹œì— ì²˜ë¦¬

---
# 1. Stub ì‚¬ìš©ë²•
Stubì´ë€, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ ìë™ ìƒì„±ëœ í”„ë¡ì‹œ ê°ì²´ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
ì¦‰, í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„œëŠ” ì›ê²©ì— ìˆëŠ” gRPC ì„œë²„ ë©”ì„œë“œë¥¼ **ë¡œì»¬ ë©”ì„œë“œì²˜ëŸ¼ í˜¸ì¶œ**í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

## 1-1. Stubì˜ ì—­í• 
1. ì§ë ¬í™”/ì—­ì§ë ¬í™” ìë™ ì²˜ë¦¬
    - í´ë¼ì´ì–¸íŠ¸ -> ì„œë²„ë¡œ ë³´ë‚¼ ìš”ì²­ ê°ì²´(ProtoBuf ë©”ì„¸ì§€)ë¥¼ ë°”ì´ë„ˆë¦¬ë¡œ ì§ë ¬í™”
    - ì„œë²„ì—ì„œ ë‚´ë ¤ì˜¨ ì‘ë‹µì„ ProtoBuf -> Java ê°ì²´ë¡œ ì—­ì§ë ¬í™”
2. ë„¤íŠ¸ì›Œí¬ í†µì‹  ì¶”ìƒí™”
    - HTTP/2 ê¸°ë°˜ìœ¼ë¡œ gRPC ìš”ì²­ì„ ì „ì†¡í•˜ê³  ì‘ë‹µë°›ëŠ” ê³¼ì •ì„ ìˆ¨ê²¨ì¤Œ
3. í˜¸ì¶œ ë°©ì‹ ì œê³µ
    - ì—¬ëŸ¬ ê°€ì§€ (ë™ê¸°, ë¹„ë™ê¸°, í“¨ì²˜) ê¸°ë°˜ í˜¸ì¶œ ì§€ì›

## 1-2. Stubì˜ ì¢…ë¥˜
#### 1) BlockingStub (ë™ê¸°)
ë©”ì„œë“œ í˜¸ì¶œì´ ëë‚  ë•Œê¹Œì§€ **í˜„ì¬ ìŠ¤ë ˆë“œê°€ ëŒ€ê¸°**í•©ë‹ˆë‹¤.
ë‹¨ìˆœí•˜ì§€ë§Œ, ë§ì€ ìš”ì²­ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” í™˜ê²½ì—ì„œëŠ” ë¶€ì í•©í•©ë‹ˆë‹¤.

#### 2) AsyncStub (ë¹„ë™ê¸°)
ìš”ì²­ì„ ë³´ë‚´ê³  `StreamObserver`ë¡œ ì‘ë‹µì„ ë¹„ë™ê¸°ë¡œ ë°›ìŠµë‹ˆë‹¤.
ì„œë²„ ìŠ¤íŠ¸ë¦¬ë°, í´ë¼ì´ì–¸íŠ¸ ìŠ¤íŠ¸ë¦¬ë°, ì–‘ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë°ì— ì í•©í•©ë‹ˆë‹¤.

#### 3) FutureStub (í“¨ì²˜)
Google Guavaì˜ ListenableFuture ê¸°ë°˜ ë¹„ë™ê¸° í˜¸ì¶œì„ í•˜ê²Œ ë©ë‹ˆë‹¤.
ì½œë°±ê³¼ ì²´ì´ë‹ ì²˜ë¦¬ì— ìœ ìš©í•©ë‹ˆë‹¤.

# 2. í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±í•˜ê¸°
## 2-1. dependency ì¶”ê°€
##### build.gradle.kts
```kts
import com.google.protobuf.gradle.*  
  
plugins {  
    ...
    id("com.google.protobuf") version "0.9.4"  
}    
  
dependencies {  
    
    // gRPC  
    implementation("io.grpc:grpc-protobuf:1.62.2")  
    implementation("io.grpc:grpc-stub:1.62.2")  
    implementation("io.grpc:grpc-netty-shaded:1.62.2")  
    implementation("net.devh:grpc-client-spring-boot-starter:3.0.0.RELEASE")  
  
    compileOnly("jakarta.annotation:jakarta.annotation-api:1.3.2")   
}  
  
protobuf {  
    protoc {  
       artifact = "com.google.protobuf:protoc:3.25.2"  
    }  
    plugins {  
       id("grpc") {  
          artifact = "io.grpc:protoc-gen-grpc-java:1.62.2"  
       }  
    }    generateProtoTasks {  
       all().forEach { task ->  
          task.plugins {  
			    id("grpc")  
			} 
       }    
   }
}  
...
```
- import com.google.protobuf.gradle.*
    - `probobuf { ... }` DSLì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ import ì¶”ê°€
- plugins
    - id("com.google.protobuf") version "0.9.4"
        - Googleì—ì„œ ì œê³µí•˜ëŠ” **protobuf-gradle-plugin** ì ìš©
        - `.proto` íŒŒì¼ì„ ìë™ìœ¼ë¡œ ì°¾ì•„ì„œ protoc ì‹¤í–‰ -> Java ì†ŒìŠ¤ ì½”ë“œ ìƒì„±
- dependencies
    - grpc-netty-shaded: gRPC ì„œë²„/í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ Netty ê¸°ë°˜ ì „ì†¡ ê³„ì¸µ ë¼ì´ë¸ŒëŸ¬ë¦¬
    - grpc-protobuf: ProtoBuf ë©”ì‹œì§€ë¥¼ gRPCì—ì„œ ì“°ê¸° ìœ„í•œ ì§ë ¬í™” ì§€ì›
    - grpc-stub: Stub í´ë˜ìŠ¤(gRPC í´ë¼ì´ì–¸íŠ¸ í”„ë¡ì‹œ ê°ì²´)ë¥¼ ì œê³µ
- protobuf
    - protoc: proto ì»´íŒŒì¼ëŸ¬(Protocol Buffers Compiler) ë²„ì „ ì§€ì •, 3.25.2 ë²„ì „ ì‚¬ìš©
    - plugins: ì¶”ê°€ ì½”ë“œ ìƒì„± í”ŒëŸ¬ê·¸ì¸ ì§€ì •
        - grpc: gRPC ì„œë¹„ìŠ¤ìš© Java ì½”ë“œ ìƒì„±ê¸° (protoc-gen-grpc-java) -> ImplBase, Stub ë“± ìƒì„±
    - generateProtoTasks
        - `.proto` íŒŒì¼ ë¹Œë“œ ì‹œ ì ìš©í•  ì‘ì—… ì •ì˜
        - ëª¨ë“  proto íŒŒì¼ì— ëŒ€í•´ gRPC í”ŒëŸ¬ê·¸ì¸ì„ ì ìš©(`task.plugins { id("grpc") }`)
        - ì´ë¡œì¸í•´ ë©”ì‹œì§€ í´ë˜ìŠ¤ + gRPC ì„œë²„/í´ë¼ì´ì–¸íŠ¸ Stub ì½”ë“œ ìë™ ìƒì„±

gradle ì˜ì¡´ ë°›ê³ , `generateProto` taskë¥¼ ì‹¤í–‰ ì‹œí‚¤ë©´, ì•„ë˜ì™€ ê°™ì´ ì½”ë“œê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤.
![[Pasted image 20250926130913.png]]

## 2-2. gRPC ì„¤ì • ì¶”ê°€
##### ê¸°ë³¸ ì„¤ì • ì¶”ê°€
```yml
// application.yml
grpc:  
  client:  
    hello:  
      address: "static://127.0.0.1:9097"  
      negotiationType: PLAINTEXT
```
- `grpc.client.hello`
    - helloë¼ëŠ” ì´ë¦„ì˜ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì •ì˜
    - ì´ ì´ë¦„ì€ `@GrpcClient("hello")`í˜•ì‹ìœ¼ë¡œ ì£¼ì…í•  ë•Œ ë§¤í•‘ ë¨
- address
    - gRPC ì„œë²„ì˜ ìœ„ì¹˜
        - static://host:port í˜•ì‹, ë‹¨ì¼ ì„œë²„ ì£¼ì†Œ
        - dns://... í˜•ì‹, DNS ê¸°ë°˜ ì„œë²„ ì£¼ì†Œ
- negotiationType
    - gRPCì˜ ì±„ë„ ë³´ì•ˆ ëª¨ë“œ
    - PLAINTEXT : TLS ì—†ì´ í‰ë¬¸, ë¡œì»¬ ê°œë°œìš©
    - TLS : TLS ì‚¬ìš©, ìš´ì˜ í™˜ê²½ì—ì„œ ê¶Œì¥

##### ì—°ê²° ê´€ë¦¬
```
grpc:  
  client:  
    hello:  
      ...
      enable-keep-alive: true  
      keep-alive-time: 60s           # Ping ì£¼ê¸°  
      keep-alive-timeout: 20s        # Ping ì‘ë‹µ ì—†ì„ ë•Œ 
      timeout      keep-alive-without-calls: true  # RPC í˜¸ì¶œ ì—†ì„ ë•Œë„ Ping ìœ ì§€
```

## 2-3. ì„œë¹„ìŠ¤ êµ¬í˜„
```java
@Service  
public class HelloService {  
  
    @GrpcClient("hello")  
    private HelloServiceGrpc.HelloServiceBlockingStub blockingStub;  
  
    public String call(String name) {  
        final HelloResponse response = blockingStub.sayHello(  
            HelloRequest.newBuilder()
	            .setName(name)
	            .build()  
        );  
        return response.getMessage();  
    }  
}
```
- `@GrpcClient("hello")`
    - `application.yml`ì—ì„œ ì„¤ì •í•œ `grpc.client.hello` ì„¤ì •ì„ ì°¾ì•„ ì±„ë„ì„ ë§Œë“­ë‹ˆë‹¤.
    - ê·¸ ì±„ë„ì„ í†µí•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Stub(BlockingStub)ì„ ì£¼ì…í•©ë‹ˆë‹¤.
- `private HelloServiceGrpc.HelloServiceBlockingStub blockingStub;`
    - `.proto`íŒŒì¼ì—ì„œ `HelloService` ì •ì˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìë™ ìƒì„±ëœ í´ë¼ì´ì–¸íŠ¸ Stub í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
    - BlockingStubì€ ë™ê¸° ë°©ì‹ìœ¼ë¡œ RPC í˜¸ì¶œí•©ë‹ˆë‹¤.
        - ë©”ì„œë“œê°€ ëë‚  ë•Œê¹Œì§€ í˜„ì¬ ì“°ë ˆë“œê°€ ë¸”ë¡œí‚¹ë©ë‹ˆë‹¤.

### 1) ë¹„ë™ê¸° Stub ì„¤ì • ë²•
```java
@GrpcClient("hello")  
private HelloServiceGrpc.HelloServiceStub stub;  
```
- StreamObserver ì½œë°±ì„ í†µí•´ ì‘ë‹µì„ ë°›ìŠµë‹ˆë‹¤.
- Server Streaming, Client Streaming

### 2) Future Stub ì„¤ì • ë²•
```java
@GrpcClient("hello")  
private HelloServiceGrpc.HelloServiceFutureStub futureStub;
```
- Guavaì˜ ListenableFutureë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
- ë¹„ë™ê¸° í˜¸ì¶œì€ í•˜ì§€ë§Œ ê²°ê³¼ë¥¼ `Future.get()` ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì œì–´í•©ë‹ˆë‹¤.
- ë‹¨ì¼ ìš”ì²­/ì‘ë‹µ(Unary RPC)ì— ì í•©í•©ë‹ˆë‹¤.
- ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ì—ëŠ” ë¶€ì í•©

# 3. ê° í†µì‹  íŒ¨í„´ í˜¸ì¶œí•˜ê¸°
## 3-1. Unary RPC í˜¸ì¶œ (ìš”ì²­ 1 <-> ì‘ë‹µ 1)
ë‹¨ìˆœ ë™ê¸° í˜¸ì¶œì´ë¼ ì½”ë“œê°€ ê°€ì¥ ê°„ë‹¨í•©ë‹ˆë‹¤.
```java
public String callUnary(final String name) {  
    final HelloRequest request = HelloRequest.newBuilder().setName(name).build();  
  
    final HelloResponse response = blockingStub  
        .withDeadlineAfter(1, TimeUnit.SECONDS)  
        .sayHello(request);  
      
    return response.getMessage();  
}
```
ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—…ì˜ ê²½ìš°, `withDeadlineAfter`ë¡œ íƒ€ì„ì•„ì›ƒ ì œì–´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
##### íƒ€ì„ì•„ì›ƒ ë°œìƒ ì‹œ
ì•„ë˜ì™€ ê°™ì€ Exceptionì´ ë°œìƒë©ë‹ˆë‹¤.
```
io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 0.884766750s. Name resolution delay 0.000000000 seconds. [closed=[], open=[[buffered_nanos=10605583, remote_addr=/127.0.0.1:9097]]]
```
##### ì‘ë‹µ
```
ë°˜ê°‘ìŠµë‹ˆë‹¤~ zinzoë‹˜
```
## 3-2. Server Streaming í˜¸ì¶œ (ìš”ì²­ 1 <-> ì‘ë‹µ N)
```java
public String callClientStreaming(String... names) throws InterruptedException {  
    CountDownLatch done = new CountDownLatch(1);  
    final StringBuilder result = new StringBuilder();  
  
    StreamObserver<HelloResponse> respObserver = new StreamObserver<>() {  
        @Override   
		public void onNext(HelloResponse value) {  
            result.append(value.getMessage());  
        }  
        @Override   
		public void onError(Throwable t) {  
            t.printStackTrace();  
            done.countDown();  
        }  
        @Override   
		public void onCompleted() {  
            System.out.println("client-stream completed");  
            done.countDown();  
        }  
    };  
  
    // ìš”ì²­ ìŠ¤íŠ¸ë¦¼ì„ ìœ„í•œ Observer íšë“  
    StreamObserver<HelloRequest> reqObserver = stub.uploadGreetings(respObserver);  
  
    // Nê°œì˜ ìš”ì²­ ì „ì†¡  
    for (String n : names) {  
        reqObserver.onNext(HelloRequest.newBuilder().setName(n).build());  
    }  
    // EOF(ì…ë ¥ ì¢…ë£Œ) ì•Œë¦¼  
    reqObserver.onCompleted();  
  
    // ìµœì¢… ì‘ë‹µ 1ê°œ ë„ì°©ê¹Œì§€ ëŒ€ê¸°  
    done.await(5, TimeUnit.SECONDS);  
    return result.toString();  
}
```
ì‘ë‹µì´ ì—¬ëŸ¬ê°œê°€ ì˜¤ê¸° ë•Œë¬¸ì—, `onNext()`ê°€ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œ ë©ë‹ˆë‹¤.
í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œë¥¼ `onCompleted()`ë¡œ ê°ì§€í•˜ê²Œ ë©ë‹ˆë‹¤.
##### ì‘ë‹µ
```
chunk: [chunk 1] ì•ˆë…•í•˜ì„¸ìš”, zinzoë‹˜
chunk: [chunk 2] ì•ˆë…•í•˜ì„¸ìš”, zinzoë‹˜
chunk: [chunk 3] ì•ˆë…•í•˜ì„¸ìš”, zinzoë‹˜
server-stream completed
```

## 3-3. Client Streaming í˜¸ì¶œ (ìš”ì²­ N <-> ì‘ë‹µ 1)
```java
public String callClientStreaming(String... names) throws InterruptedException {  
    CountDownLatch done = new CountDownLatch(1);  
    StringBuilder result = new StringBuilder();  
  
    StreamObserver<HelloResponse> responseObserver = new StreamObserver<>() {  
        @Override  
        public void onNext(HelloResponse value) { // ìµœì¢… 1íšŒ  
            result.append(value.getMessage());  
        }  
        @Override  
        public void onError(Throwable t) {  
            Status status = Status.fromThrowable(t);  
            System.err.println("[client-stream][error] " + status.getCode() + " - " + s.getDescription());  
            done.countDown();  
        }  
        @Override  
        public void onCompleted() { done.countDown(); }  
    };  
  
    // í•„ìš” ì‹œ ë°ë“œë¼ì¸: asyncStub = asyncStub.withDeadlineAfter(10, TimeUnit.SECONDS);  
    StreamObserver<HelloRequest> requestObserver = stub.uploadGreetings(responseObserver);  
  
    try {  
        for (String it : names) {  
            requestObserver.onNext(HelloRequest.newBuilder()
	            .setName(it)
	            .build()
			);  
        }  
        requestObserver.onCompleted(); // EOF ì•Œë¦¼ â†’ ì„œë²„ê°€ ìµœì¢… ì‘ë‹µ ìƒì„±  
        boolean finished = done.await(15, TimeUnit.SECONDS);  
        return finished ? result.toString() : "TIMEOUT";  
    } catch (Throwable t) {  
        requestObserver.onError(t); // ì „ì†¡ ì¤‘ ì˜¤ë¥˜ ì‹œ ìŠ¤íŠ¸ë¦¼ì— ì—ëŸ¬ ì „ë‹¬  
        throw t;  
    }  
}
```
- `StreamObserver<HelloResponse> responseObserver = new StreamObserver<>() {...}`
    - ì„œë²„ì— ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” ì½œë°± ë¦¬ìŠ¤ë„ˆ
    - `onNext`
        - ì„œë²„ê°€ ì‘ë‹µì„ ë‚´ë ¤ì¤„ ë–„ í˜¸ì¶œ
        - Client Streamingì—ì„œëŠ” ì‘ë‹µì´ í•œ ë²ˆë§Œ ì˜¤ë¯€ë¡œ ì—¬ê¸°ì„œ ìµœì¢… ë©”ì„¸ì§€ ì €ì¥
    - `onError`
        - ì„œë²„ ìª½ì—ì„œ ì—ëŸ¬ ë°œìƒ ì‹œ í˜¸ì¶œ
        - gRPCì˜ Status ê°ì²´ë¡œ ë³€í™˜í•´ ë¡œê·¸ ì¶œë ¥
    - `onCompleted`
        - ì„œë²„ ì‘ë‹µ ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ ì‹œ í˜¸ì¶œ
        - done.countDown()ìœ¼ë¡œ ëŒ€ê¸° ì¤‘ì¸ ìŠ¤ë ˆë“œë¥¼ ê¹¨ì›€
- `StreamObserver<HelloRequest> reqObserver = stub.uploadGreetings(responseObserver);`
    - ì„œë²„ì—ì„œ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ìŠ¤íŠ¸ë¦¼ í•¸ë“¤ëŸ¬ë¥¼ í­ë“
    - `stub.uploadGreetings(...)` : ì„œë²„ì˜ RPC í˜¸ì¶œ
    - `responseObserver`ëŠ” ì„œë²„ ì‘ë‹µ ì²˜ë¦¬ ì½œë°±
- `for (String it : names) { ... }`
    - `onNext()`ë¥¼ í˜¸ì¶œ í•¨ìœ¼ë¡œì¨ ìš”ì²­ Nê°œê°€ ë°œìƒí•˜ëŠ” ë¶€ë¶„
- `reqObserver.onCompleted();`
    - ëª¨ë“  ìš”ì²­ ì „ì†¡ì´ ëë‚¬ìŒì„ ì„œë²„ì— ì•Œë¦¼
    - í•´ë‹¹ ì‹ í˜¸ë¥¼ ë°›ì€ ì„œë²„ì—ì„œëŠ” ìµœì¢… ì‘ë‹µ í•œê°œë¥¼ ë§Œë“¤ì–´ `responseObserver.onNext()`ë¡œ ì „ë‹¬
##### ì‘ë‹µ
```json
{
  "message": "ì•ˆë…•í•˜ì„¸ìš”, aë‹˜, ì•ˆë…•í•˜ì„¸ìš”, bë‹˜"
}
```

## 3-4. Bidirectional Streaming í˜¸ì¶œ (ìš”ì²­ N <-> ì‘ë‹µ N)
```java
public void callBidiStreaming(String... names) throws InterruptedException {  
    CountDownLatch done = new CountDownLatch(1);  
  
    // ì„œë²„ ì‘ë‹µ ì²˜ë¦¬ ë¦¬ìŠ¤ë„ˆ  
    StreamObserver<HelloResponse> responseObserver = new StreamObserver<>() {  
        @Override  
        public void onNext(HelloResponse value) {  
            System.out.println("[bidi][resp] " + value.getMessage());  
        }  
        @Override  
        public void onError(Throwable t) {  
            var st = io.grpc.Status.fromThrowable(t);  
            System.err.println("[bidi][error] " + st.getCode() + " - " + st.getDescription());  
            done.countDown();  
        }  
        @Override  
        public void onCompleted() {  
            System.out.println("[bidi] stream completed");  
            done.countDown();  
        }  
    };  
  
    // ìš”ì²­ ìŠ¤íŠ¸ë¦¼ Observer íšë“ (ìš”ì²­ ë³´ë‚¼ í†µë¡œ)  
    StreamObserver<HelloRequest> reqObserver = stub.chat(responseObserver);  
  
    try {  
        for (String n : names) {  
            System.out.println("[bidi][send] " + n);  
            reqObserver.onNext(HelloRequest.newBuilder().setName(n).build());  
            Thread.sleep(1000); // ì¼ë¶€ëŸ¬ ì§€ì—° â†’ ì„œë²„ ì‘ë‹µê³¼ êµì°¨ ê°€ëŠ¥  
        }  
        reqObserver.onCompleted(); // ìš”ì²­ ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ ì•Œë¦¼  
        done.await(10, TimeUnit.SECONDS); // ì‘ë‹µ ì™„ë£Œê¹Œì§€ ëŒ€ê¸°  
    } catch (Throwable t) {  
        reqObserver.onError(t);  
        throw t;  
    }  
}
```

##### ì‘ë‹µ
```
[bidi][send] a
[bidi][resp] [bidi] ì•ˆë…•í•˜ì„¸ìš”, aë‹˜
[bidi][send] b
[bidi][resp] [bidi] ì•ˆë…•í•˜ì„¸ìš”, bë‹˜
[bidi][send] c
[bidi][resp] [bidi] ì•ˆë…•í•˜ì„¸ìš”, cë‹˜
[bidi] stream completed
```

---
# ëŠë‚€ì 

ë‹¨ìˆœ ì˜ˆì œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ì„œ, ìš”ì²­ Nì´ë‚˜ ì‘ë‹µ Nì˜ ê²½ìš°(Bidirectional Streaming)ëŠ” ì–¸ì œ ì¨ì•¼ í• ì§€ ì˜ ê°ì´ ì•ˆ ì˜¤ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.
ë‹¤ë§Œ, í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„œ ë‹¨ìˆœ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ë§Œìœ¼ë¡œ ì‹¤í–‰ì´ ë˜ëŠ” ê±¸ ì§ì ‘ ì‹¤ìŠµì„ í•´ ë³´ë‹ˆ ë„ˆë¬´ ì‹ ê¸°í•˜ë‹¨ ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.

Future Stub ê°™ì€ ê²½ìš°ì—ë„ ì–´ë–»ê²Œ í™œìš©í•˜ë©´ ì¢‹ì„ì§€ ì•„ì§ì€ ì˜ ëª¨ë¥´ê² ë‹¤ë§Œ ^^;
ì´ëŸ¬í•œ ê¸°ë³¸ì´ ê²°êµ­ ë‚˜ì¤‘ì— í•„ìš”í•  ë•Œ ê¸°ë°˜ì´ ëœë‹¤ëŠ” ê²ƒì„ ìŠì§€ì•Šê³ ...

ë°”ë¡œ ë‹¤ìŒì€ ì—ëŸ¬ ì²˜ë¦¬ì™€, ë©”íƒ€ë°ì´í„° ìš”ì²­ ë³´ë‚´ëŠ” ë°©ì‹ ë“±ì— ëŒ€í•´ì„œ ì‹¤ìŠµí•´ ë³´ê³ ì í•©ë‹ˆë‹¤.